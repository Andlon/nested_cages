\section*{Appendix: Pseudocode}
%
\label{app:pseudocode}

\begin{algorithm}
  \caption{$\text{Shrink}(\Cinp,\Fout) \rightarrow H$}
  \KwData{\\
    \begin{tabular}{ll}
      $\Cinp$ &  Initial coarse mesh (will remain constant) \\
      $\Fout$ &  Initial fine mesh (possibly overlapping with $\Cinp$) \\
    \end{tabular}
  }
  \KwResult
  {\\
    \begin{tabular}{ll}
      $H$  & history of shrinking $\Fout$ vertices inside $\Cinp$ so that \\
      & $H_j \rightarrow \FVflow(j \Delta t)$ the shrinking fine mesh.
    \end{tabular}
  }
  \Begin{
    $\Delta t = 1\mbox{\text{e}-}3$ \comment{Default time step} \\
    $H = \{ F \}$ \comment{Initialize history with input fine mesh} \\
    \While{\upshape{$\Cinp$ does not nest $H$\text{.last}}}
    {
    $\nabla Φ  = 0$ \comment{Initialize gradients to zero} \\
    \For{\upshape{each quadrature point $\pflow_i $ on $H$.last}}
    {
      $\q = \text{closest point to } \pflow_i \text{ on }\Cinp$ \\
      $s = \left\{ \begin{array}{cl} 1, & \text{ if }\pflow_i\text{ is outside }\Cinp \\
             -1, & \text{otherwise} \end{array} \right.$ \comment{distance sign} \\
	 \uIf {$\| \pflow_i - \q \| > 1\mbox{\upshape{e}-}5$}
	 {
	 $\g = s \dfrac{\pflow_i-\q}{\|\pflow_i - \q\|}$ \\
	 }
	 \Else{
         	$\g = \n(\q)$ \comment{if $\pflow_i$ is too close to $\q$ define} \\
	        \comment {gradient as surface normal at $\q$} \\
	        \comment{\cite{Baerentzen:2005:SDC}}  \\
         }
         \For{\upshape{each vertex $j$ in $H$.last}}
         {
         	$\nabla Φ (j) \mathrel{+}= w_i \lambda_{ij} \g$  \comment{$w_i$ is the weight of the} \\
	\comment{ quadrature point and $\lambda_{ij}$} \\
	\comment{ is the hat function of vertex } \\
	\comment{$j$ evaluated at quadrature point $\pflow_i$} \\
         }        
         
    }
    $ H \text{.append}( H\text{.last} - \Delta t \cdot \nabla Φ$  )
    }
    \Return $H$ 
  }
  \label{alg:shrink}
\end{algorithm}

\begin{algorithm}
  \caption{$\text{Reinflate}(H,\Cinp,\text{Energy}) \rightarrow C$}
  \KwData{\\
    \begin{tabular}{ll}
       $H$  & history of shrinking $\Fout$ vertices inside $\Cinp$ so that \\
      & $H_j \rightarrow \FVflow(j \Delta t)$ the shrinking fine mesh. \\
      $\Cinp$ &  Initial coarse mesh \\
      Energy &  Function object to compute re-inflating energy and gradient \\
    \end{tabular}
  }
  \KwResult
  {\\
    \begin{tabular}{ll}
      $C$ & Final nested cage \\
    \end{tabular}
  }
  \Begin{
    $F0 = H$.first  \\
    $F = H$.pop \\
    $C = \Cinp$
    \While{\upshape{$H$ is not empty}}
    {
    $\beta  = \beta_{\text{init}} ( \ = 1\mbox{\text{e}-}2)$ \comment{Initial step size} \\
    $E_{\text{min}} = \infty$ \comment{Initialize energy value to infinity} \\
    \Repeat{}
    {
      $\U_F = H\text{.pop} - F $ \\
       \comment{Desired velocities for fine mesh} \\
      $\U_C = - \beta \cdot \nabla \text{Energy} (F_0,C,\Cinp)$ \\
       \comment{Desired velocities for coarse mesh} \\
       $\U_C = \text{VelocityFilter}(F,\U_F,C,\U_C)$ \\
        \comment{Filter velocities to prevent collisions} \\
	 \uIf {\upshape{Energy}$(C+\U_C)>E_{\text{min}}$}
	 {
	 $\beta \mathrel{*} = 0.5$ \comment{Decrease step size} \\
	 \If{$\beta < \beta_{\text{min}} ( \ = 1\mbox{\upshape{e}-}3)$} 
	 {
	    \textbf{break} \comment{Give up} \\
	 }
	}
	 \Else{
         	$E_{\text{min}} = \text{Energy}(C+\U_C)$ \comment{Update energy}\\
		$C \mathrel{+}= \U_C$ \comment{Take step} \\
		$\beta \mathrel{*}= 1.1$ \comment{Slightly increase step size}
         }  
         $\Delta C = 1\mbox{\upshape{e}-}5$ \comment{Smallest movement allowed} \\
         \If{$\| \U_C \| < \Delta C$}
	 {
	    \textbf{break} \comment{Declare convergence} \\
	 }
         
    }

    }
    \Return $C$ 
  }
  \label{alg:reinflate}
\end{algorithm}