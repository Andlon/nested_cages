\section*{Appendix: Pseudocode}
%
\label{app:pseudocode}

\noindent Obs. Alg. 1: \textsc{Decimate} has to output an intersection-free mesh.

\begin{algorithm}
   \caption{Nested Cages algorithm (Section 3).}
   \label{alg:NestedCages}
   \begin{algorithmic}[1]
      \Procedure{NestedCages}{$\widehat{M}_0,L,\Delta t,E,\beta_{\mathrm{init}},\beta_{\mathrm{min}},\Delta_C$} \Comment{$\widehat{M}_0 = (\mathbf{M}_0,\mathbf{T}_0)$}
      \State $N \gets \textsc{Size}(L)$
      \For{$i \in \{ 1, \ldots, N \}$}
       \State $\widehat{M}_i \gets \textsc{Decimate}(M_{i-1},L(i))$  \Comment{$\widehat{M}_i = (\mathbf{M}_i,\mathbf{T}_i)$}
       \State $\mathbf{F} \gets \textsc{ShrinkingFlow}(M_{i-1}, \widehat{M}_i,\Delta t)$
       \State $\mathbf{M}_i \gets \textsc{ReInflate}(\textbf{F},\textbf{T}_{i-1},\widehat{M}_i,E,\beta_{\mathrm{init}},\beta_{\mathrm{min}},\Delta_C)$
       \State $M_i \gets (\mathbf{M}_i,\mathbf{T}_i) $ \Comment{Output cage}
      \EndFor
      \State \textbf{return} $M$
      \EndProcedure
   \end{algorithmic}
\end{algorithm}

\noindent Obs. Alg.2: $\bullet$ We do not perform line search as written in the text (because it doesn't improve the quality
of results and is more expensive). \\
$\bullet$ $s^*(\textbf{F},\widehat{C})>0$ means signed distance of some point in $\mathbf{F}$ w.r.t. $\widehat{C}$ is positive. \\
$\bullet$ Need to include quadrature order?

\begin{algorithm}
   \caption{Flow algorithm (Section 3.1).}
   \label{alg:ShrinkingFlow}
   \begin{algorithmic}[1]
      \Procedure{ShrinkingFlow}{$\overline{F},\widehat{C},\Delta t$} \Comment{$\overline{F} = (\overline{\mathbf{F}},\overline{\mathbf{T}})$}
      \State $i \gets 0$
      \State $\textbf{F}_0 \gets \overline{\mathbf{F}}$
      \While{$(\textbf{F}_i, \textbf{T}) \cap \widehat{C} \neq \emptyset \ || \ s^*(\textbf{F}_i,\widehat{C})>0 $}
       \State $i \gets i+1 $
       \State $\textbf{F}_i \gets \textbf{F}_{i-1} - \Delta t \cdot  \nabla_{\textbf{f}} \Phi(\textbf{F}_{i-1})$\Comment{Detials in (2) through (6)}
      \EndWhile
      \State \textbf{return} $\mathbf{F}$
      \EndProcedure
   \end{algorithmic}
\end{algorithm}

\noindent Obs. Alg.3 : $\bullet$ Standards: $\beta_{\mathrm{init}} = 10^{-2}$, $\beta_{\mathrm{min}} = 10^{-3}$,
$\Delta_C = 10^{-5}$ \\
$\bullet$ Do I need to explain details on \textsc{CollisionResponse}? For example, change of resolution of
the spatial hierarchy, elimination of one of the phases that returned solution for the soft problem and substring?

\begin{algorithm}
   \caption{Reinflation algorithm (Section 3.2).}
   \label{alg:ReInflation}
   \begin{algorithmic}[1]
      \Procedure{ReInflate}{$\textbf{F},\textbf{T},\widehat{C},E,\beta_{\mathrm{init}},\beta_{\mathrm{min}},\Delta_C$}
      \State $n = \textsc{Size}(\textbf{F})+1$
      \For{$i \in \{n, \ldots 1 \}$}
      \State $E_{\mathrm{min}} \gets \infty$
      \While{$progress> \Delta_C$}
      \State $\widehat{C}_{\mathrm{prev}} \gets \widehat{C}$
      \State $\mathbf{U}_C^* \gets -\nabla E (\widehat{C}) $ 
      \State $\beta \gets \beta_{\mathrm{init}}$
      \While{$\beta > \beta_{\mathrm{min}} \ \& \& \ progress> \Delta_C$}
      \State $\widehat{C}_\mathrm{att} \gets \textsc{CollisionResponse}(...)$
      \If{$E(\widehat{C}_{\mathrm{att}}) < E_{\mathrm{min}}$}
      \State $\widehat{C} \gets \widehat{C}_{\mathrm{att}}$
      \State $\beta = 1.1 \beta$
      \State $E_{\mathrm{min}} \gets E(\widehat{C}_{\mathrm{att}})$
      \Else
      \State $\beta = 0.5 \beta$
      \EndIf
      \EndWhile
      \EndWhile
      \EndFor
      \State \textbf{return} $\mathbf{C}$
      \EndProcedure
   \end{algorithmic}
\end{algorithm}