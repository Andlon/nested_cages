\section{Results and applications}
\label{sec:results}

\alec{We should say where we get the decimations and reference the decimators
comparison figure.}

\leo{To-do: energy comparisons}

The possibility of specifying different energies in our method
gives it great flexibility to handle a variety of applications. For example,
given an input high-resolution mesh,
a high-quality quadrilateral mesh can be generated by
the method described in \cite{Takayama:2013} (Figure XX). For some tasks
(\leo{Please add them here}) it is desired for the quads to be coplanar,
and \leo{(Another paper here)} can be applied to achieve it.
For deformation purposes it is also desired the quad mesh to be exterior to the input mesh. 
We triangulate the quad mesh and apply our method to obtain a
coarse cage. As we wish to recover a quad mesh in the end, we minimize
the volume of the tetrahedra defined by the vertices of the coming from 
the facets of the quad mesh (Figure).
We can also sum a multiple of the ARAP energy to this coplanarity energy
to have a final quad mesh intrinsically closer to the initial one.

In animation it is often desired to have a cage that respects semantic
properties of the object, such as symmetry. In the case where a symmetric overlapping
decimation was designed by an artist (Figure~\ref{fig:swat-cage}, left), we can use our method 
to obtain a fully exterior that preserves symmetry, by minimizing a symmetry energy. 
There is no need for the input fine mesh to be symmetric, as demonstrated
by our result in Figure~\ref{fig:swat-cage}. We also point that our method works
even if the input mesh has a lot of problems, since it is agnostic to input mesh quality.

\begin{figure}
  \includegraphics[width=\linewidth]{figs/swat-cage}
  \caption{The \emph{S.W.A.T. man} is an artifact-ridden mesh with 2806 pairs
  of intersecting triangles, 24 non-manifold edges, 51 boundary loops and 51
  connected components. Our shrinking flow to the input overlapping coarse cage
  is robust to such artifacts. Once inside, we re-inflate and produce a fully
  exterior cage used to deform the embedded model.}
  \label{fig:swat-cage}
\end{figure}

Figure~\ref{fig:decimations} shows how our results inherit the quality
of the different initial decimations. When a more adaptive result is desired,
one can use the initial decimations provided by the OpenMesh library \cite{openmesh}. 
On the other hand, plugging into our method the decimations obtained by the CGAL
library \cite{cgal} leads to more regular nested cages.

\begin{figure}
  \includegraphics[width=0.32\linewidth]{figs/decim_holder_0}
    \includegraphics[width=0.32\linewidth]{figs/decim_holder_1}
      \includegraphics[width=0.32\linewidth]{figs/decim_holder_2}
  \caption{Our cages inherit regularity from the prescribed initial decimations. 
  \leo{Etienne: Can you please generate a rendering like above.
  The meshes are in ToRender/decimations\_final folder. Is it possible to show wireframe?}}
  \label{fig:decimations}
\end{figure}

Our method can also handle noisey input as shown in Figure~\ref{fig:noisy-bunny}.
We added noise in the normal direction for the top model and 
re-ran our pipeline with the exact settings, leading to the cages on the bottom.
It can be seen that noise is smoothed out across layers. 

\begin{figure}
  \includegraphics[width=\linewidth]{figs/noisy-bunny}
  \caption{Noise add in the normal direction to the input bunny does not
  affect our ability to generate seven quality outer layers.}
  \label{fig:noisy-bunny}
\end{figure}

In Figure~\ref{fig:horse-25-layers} we show that our method generates
25 cages keeping tight-fitness across layers. Indeed most of the cages
are almost indistinguishable and difference can only be seen when
the figure is zoomed considerably. 

\begin{figure}
  \includegraphics[width=\linewidth]{figs/horse-25-layers}
  \caption{Our tight nesting property is robust even when the number of layers
  is large.}
  \label{fig:horse-25-layers}
\end{figure}

To showcase the quality and robustness of our method we present more results 
in Figure~\ref{fig:zoo}. \leo{Comment quality of specific results when the zoo is completely done}.
Tabel~\ref{tab:timings} present timing data for some of the results. The table shows
that the most time-consuming part of our pipeline is the physical simulation, as expected.


Despite harmonic coordinates being theoretically defined for arbitrary
polyhedra, previous works implement them only on triangle mesh cages
\cite{HarmonicCoodinates07}.
%
To utilize popular quad-dominant meshes as cages, all faces must be outside the
input model and \emph{planar}.
%
Such cages are difficult to model manually, hence opting to simply triangulate
any high-order facets \cite{HarmonicCoodinates07}.
%
We complement the recent sketch-based quad meshing tool \cite{Takayama:2013},
post-processing its output to enclose the input model and 
minimize a planarization energy \cite{poranne2013interactive}.
%
Quad-dominant cages are easier to control as their visualization is less
cluttered (see \reffig{hand-hc}).
%
More importantly, harmonic coordinates constructed (via their recursive
definition) on the planar-quad polyhedron are also higher quality:
coordinates are smooth functions inside each quad.
%
In contrast, coordinates would depend heavily on the chosen triangulation.

\begin{figure}
  \includegraphics[width=\linewidth]{figs/octopus-poisson}
  \caption{A single multiresolution v-cycle takes 1.4 secs on this 7M-vertex
  volumetric Poisson equation in the \emph{Octopus}. With 14 more iterations
  (21 secs) the residual error matches a direct solver's (11 mins, back
  substitution only).}
  \label{fig:octopus-poisson}
\end{figure}

\begin{figure}
  \includegraphics[width=\linewidth]{figs/hand-hc}
  \caption{Left to right: an quad mesh is quickly sketched atop the \emph{Hand}
  and our pipeline moves it outside the input while planarizing quads. A
  cage-based deformation is applied via harmonic coordinates computed over the
  volume inside the planar-quad polyhedron (a few coordinates visualized in
  pseudocolor). These weights are smooth inside each quad. In contrast,
  triangulating the quads would lead to non-smooth, meshing-dependent values in
  each quad (two alternative triangulations).}
  \label{fig:hand-hc}
\end{figure}

\leo{Is here a good place for implementation details?}
\alec{Usually this comes at the end of the method of the beginning of the
results.}

\leo{To-do: Human inside armour (Leo)}

\leo{To-do: Efficient physical simulation with the simulation (Etienne)}

\leo{To-do: Efficient physical simulation with the simulation (Alec)}

\input{timings_table}


%
Constructing our nested cages can be considered expensive \emph{precomputation}
for a multiresolution linear system solver.
%
However, once meshes are computed the multigrid solver is sleek and memory
efficient.
%
A single multiresolution V-cycle for a Poisson equation with Dirichlet boundary
conditions inside the volume of the \emph{Octopus} with over seven million
vertices, takes 1.4 seconds using 2GB max memory. With 14 more V-cycles the
solution converges for a total time of 21 seconds (see
\reffig{octopus-poisson}).
%
In contrast, \textsc{Matlab}'s backslash operator thrashes when using over 22GB
of memory finishing in over 16 minutes.
%
\textsc{Cholmod}'s Cholesky factorization with reordering is mildly better than
\textsc{Matlab}, solving via backsubstitution in 10 minutes, but suffers from
similar memory issues during the pre-factorization procedures, which takes over
an hour to complete using 17GB max memory.
%
In terms of precomputation, our time consuming cage computation lives at a much
earlier stage than pre-factorization: before determining constraints or
boundary conditions and before even choosing the particular system being
solved.

\begin{wrapfigure}{r}{1.02in}
%
\centering
%
\includegraphics[width=\linewidth]{figs/pelvis-plot}
%
\end{wrapfigure}
%
As we do not alter the core iterative nature of multiresolution, we benefit
from its flexibility. For example, we may quickly change the diffusion rate in
a heat equation solved in the volume of the \emph{Pelvis} (see
\reffig{pelvis-diffusion}). 
%
Factorization based solvers, in general scrap previous precomputation after
such a global change to the system matrix. 
%
Multiresolution hardly notices and may even use previous solutions as a warm
start if changes to the system are slight.
%
In this example, we employ Neumann boundary conditions and notice that naively
decimating the input mesh leads to a divergent solver (inset).

\begin{figure}
  \includegraphics[width=\linewidth]{figs/pelvis-diffusion}
  \caption{We solve a diffusion equation $(λ∆+I) x = b$ for various diffusion
  rates $λ$ with our nested cages in a multiresolution solver (top: surface
  values via Neumann boundary conditions, bottom: slice through tet-mesh
  volume).}
  \label{fig:pelvis-diffusion}
\end{figure}

\subsection{Needs figures made:}
- Zoo:
  - anchor
  - arma
  - bunny
  - gargo
  - Model1
  - Model3
  - Model6
  - Model7
  - Model9
  - pelvis
  - octopus
  - horse
- couplingdown comparison of decimators
- rampant stress test with small number of layers vs CGAL
- cgal iso surface generation comparison vs CGAL
- Plain decimation creating bad overlaps
- kenshi's hand


- failure case for simpler flows: mean curvature flow on fine mesh does not
  go inside coarse mesh, may even intersect itself
    - pelvis or rampant failing to go inside at all
    - octopus flowing inside but shrinking too much and puts parts in wrong
      place
    - or 2d flow
- voxelize to get containing shell--> decimate --> run our pipeline to force
  outside: use for volumetric calculations: This has the benefit that the
  containing mesh is nice quality (cf. \cite{Jacobson:WN:2013}) and tightly
  fitting (cf. \cite{Xu:2014:SDF}).
- didactic 2D figures
  - flow
  - expansion
- rampant 100 layers
+ swat symmetry cage
+ Kenshi's hand: planarization energy + arap
- Kenshi's hand: compute HC and make cage-based deformation

- comparison of volumetric arap, surface arap, volume
+ bunny: add random noise to initial model and run pipeline
  + rerun with higher resolution
- xyz-dragon High resolution stress test
+ alec: implement multigrid
  + Multigrid Poisson equation. Show that naive non-nested meshes will have
    poor/no convergence: alligator teeth, etc.
      - generic poisson equation in 2d and in 3d
        + compare to level set decimation
        + compare to qslim
      - geodesics in heat 
  - Multires automatic skinning weights (i.e. QP solve). See Baohua Wu's thesis.
  - Multi-res ARAP deformation/physical elastics
  - Bijective mapping (Locally injective mapping of tet mesh conforming to all
    layers): maintains nesting.
- beast for zoo

- cartoon heart
- left atrium
- flow Model3 (human) inside and inflate Model4 (armour)
- buddha using open flipper decimation
- propagate cages along animation sequence (just re-inflation)
- cage transfer: transfer horse cage to giraffe

\alec{discuss how we chose our default decimation ratio}

\begin{figure*}
  \includegraphics[width=\linewidth]{figs/zoo}
  \caption{Each row shows left to right: input model, slice through all nested
  layers, and outermost, coarsest layer.}
  \label{fig:zoo}
\end{figure*}
