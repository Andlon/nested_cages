% Model9 - eps = 1e-3
[V0,F0] = load_mesh('Model9_0.obj');
[V_coarse{1},F_coarse{1}] = load_mesh('Model9_input_1.obj');
[V_coarse{1},F_coarse{1}] = meshfix_matlab(V_coarse{1},F_coarse{1});
[cages_V,cages_F,~,~,~,timing] = ...
multires_per_layer( ...
V0,F0, [0],...
'QuadratureOrder',2, ...
'ExpansionEnergy','displacement_path', ...
'FinalEnergy','volume', ...
'BetaInit',1e-2, ...
'EpsExpansion',1e-2,...
'EpsFinal',1e-3,...
'V_coarse',V_coarse,'F_coarse',F_coarse,...
'PartialPath','partial_01_16.mat');
write_cages('Model9_0001',cages_V,cages_F);

% Model9 - eps = 2e-4
[V0,F0] = load_mesh('Model9_0.obj');
[V_coarse{1},F_coarse{1}] = load_mesh('Model9_input_1.obj');
[V_coarse{1},F_coarse{1}] = meshfix_matlab(V_coarse{1},F_coarse{1});
[cages_V,cages_F,~,~,~,timing] = ...
multires_per_layer( ...
V0,F0, [0],...
'QuadratureOrder',2, ...
'ExpansionEnergy','displacement_path', ...
'FinalEnergy','volume', ...
'BetaInit',1e-2, ...
'EpsExpansion',2e-3,...
'EpsFinal',2e-4,...
'V_coarse',V_coarse,'F_coarse',F_coarse,...
'PartialPath','partial_01_16.mat');
write_cages('Model9_00002',cages_V,cages_F);
