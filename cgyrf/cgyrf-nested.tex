\documentclass{cgyrf15}
% The packages graphicx, amssymb, and amsmath are already loaded via
% cgyrf15.cls

%----------------------- Macros and Definitions --------------------------

% Add all additional macros here, do NOT include any additional files.

% Nice table
\usepackage[table]{xcolor}
\usepackage{tabularx}
\usepackage{booktabs}
\definecolor{lightbluishgrey}{rgb}{0.9,0.91,0.95}
\newcommand{\ra}[1]{\renewcommand{\arraystretch}{#1}}
\newcommand{\NO}{{\color{red}\textsf{X}}}
\newcommand{\YES}{$\bullet$}
\newcommand{\alec}[1]{{\textcolor[rgb]{0.1,0.6,0.1}{\textbf{Alec:} #1}}}
\newcommand{\leo}[1]{{\textcolor[rgb]{0.8,0.0,0.0}{\textbf{Leo:} #1}}}


%----------------------- Title -------------------------------------------

\title{Nested Cages}

\author{
Leonardo Sacht\thanks{Universidade Federal de Santa Catarina, Brazil.} \and
Alec Jacobson\thanks{Columbia University, USA.} \and
Etienne Vouga\thanks{University of Texas at Austin, USA.} 
}

\begin{document}

\maketitle

\begin{abstract}
Many tasks in geometry processing and physical simulation benefit from
multiresolution hierarchies: efficient PDE solving, collision detection
culling, physically based simulation, and cage-based geometric modeling. We
propose an algorithm to generate coarse domain approximations that satisfy
several desiderata for efficient and accurate multiresolution algorithms: the
coarsened domains respect the original topology, strictly enclose the original
object, yet fit as tightly as possible.
\end{abstract}

\section{Introduction}

As the complexity and size of computational objects continue to grow,
acceleration algorithms become increasingly important. One powerful technique
is to decompose a high-resolution mesh into a hierarchy of increasingly coarse
approximations or \emph{cages} (see Figure~\ref{fig:bunny-shelf-teaser}). For example,
multiresolution FEM techniques efficiently solve Eulerian PDEs on very fine
meshes by moving up and down the hierarchy.  Coarse enclosing cages also find
use in: physical simulation, where deformations of the cage are interpolated
onto embedded high-resolution geometries; interactive animation, where
artists specify large-scale deformations by adjusting the low-dimensional cage;
and collision detection, where conservative culling reduces computation
time. 
%For all these applications, the key to high performance is the ability to
%generate a quality multiresolution.

Existing techniques such as surface mesh decimation \cite{Hoppe:1996:PM}, 
voxelization \cite{Xian:2009}, or
contouring distance level sets \cite{Shen:2004:IAI}, violate one or more of three characterstics:
strict nesting, homeomorphic topology and geometric closeness
(Table~\ref{tab:feature-chart}).  Instead, our methods successively constructs
each next-coarsest level of the hierarchy, using a sequence of decimation,
flow, and contact-aware optimization steps.  From coarse to fine, each layer
then fully encages the next while retaining a snug fit and respecting the
original surface topology.

\begin{figure}[t]
  \includegraphics[width=\linewidth]{figs/bunny-shelf-teaser}
  \caption{Given an input shape (top left), our method constructs \emph{nested} cages:
each subsequent mesh is coarser than the last and fully encloses it without
intersections. A slice through all layers (right), shows a tightly
encaged \emph{Bunny}.\vspace*{-1em}
  }
  \label{fig:bunny-shelf-teaser}
\end{figure}

\begin{table}
\centering
\ra{1.0}
\setlength{\tabcolsep}{5.5pt}
\rowcolors{2}{white}{lightbluishgrey}
\begin{tabularx}{\linewidth}{X c c c}
\rowcolor{white}
\toprule
Method               & \textsc{Homeom.} & \textsc{Nesting}& \textsc{Tight} \\
\midrule                                                                       
\textbf{Our method}  & \YES                  & \YES            & \YES           \\
\emph{Decimation}                                                               
                     & \YES                  & \NO             & \YES           \\
\emph{Voxelization}                                                             
                     & \NO                   & \YES            & \NO            \\
\emph{Level-set}                                                                
                     & \NO                   & \YES            & \NO            \\
\bottomrule
\end{tabularx}
\caption{
%Hierarchy construction feature chart: 
Previous techniques fall short
on one property or another, while ours satisfies all of them.}
\label{tab:feature-chart}
\end{table}

\section{Method}

The input to our method is a sequence of decimations of the original mesh which
match its topology, but, in general, overlap (e.g. the ones computed by
\cite{cgal}). The output is a new embedding for each mesh (i.e.\ new vertex
positions) such that each tightly contains all finer meshes. Our approach works
pairwise, from finest to coarsest: given fine mesh positions $\mathbf{F}$, we
find a new embedding $\mathbf{C}$ for the next coarser mesh so that it encloses
$\mathbf{F}$. The resulting $\mathbf{C}$ is treated as the fine mesh for the
next layer and so on. Each layer inductively encages all finer layers.

The pairwise problem is broken down into two stages: \emph{flow} the fine mesh
completely inside the coarse mesh  (Figure~\ref{fig:swat}) and then \emph{re-inflate} the
fine mesh to its original position while pushing the coarse mesh outward.

\begin{figure*}[t]
  \includegraphics[width=\linewidth]{figs/zoo_mini}
  \caption{We show robustness of our method by generating 50 nested cages
  around \emph{Max Plank}'s head (left). For the \emph{Octopus} mesh we have
  generated 7 volume minimizing cages and for the higher-genus
  \emph{Feritility} we have generated 7 layers minimizing surface deformation.
  }
  \label{fig:minizoo}
\end{figure*}

\noindent \textbf{Flow:} We first find new positions $\mathbf{F}$ for the fine
mesh that minimize total signed distance to $\mathbf{C}$ integrated over all
deforming surface points $\textbf{p} \in F$ \begin{equation}
\Phi(\mathbf{F}) = \int_F s(\mathbf{p})
D(\mathbf{p}) dA, \label{eq:flow_energy} \end{equation} where
$D(\mathbf{p})$ is the unsigned distance from $\mathbf{p}$ to $\mathbf{C} $
and $s(\mathbf{p})$ modulates by the appropriate sign
($1$ outside $-1$ inside). We minimize this energy by taking small steps opposite the gradient direction
for each vertex position $\mathbf{f}$ in $\mathbf{F}(t)$
as a function of a fictitious time variable $t$:
\begin{equation}
\frac{\partial \mathbf{f}}{\partial t} = - \nabla_{\mathbf{f}} \Phi(\mathbf{F}).
\label{eq:energy_gradient}
\end{equation}

%\begin{figure*}[t]
 % \includegraphics[width=\linewidth]{figs/rampant-flow}
 % \caption{Write caption}
 % \label{fig:rampant-flow}
% \end{figure*}

This flow is non-trivial to discretize. We first approximate the integral with
higher-order quadrature points sampled inside fine mesh facets. 
%Then we employ
%a technique common to surface registration. 
During each small step of the flow,
for each point $\textbf{p}$ we freeze its associated closest point
on $\mathbf{C}$, therefore linearizing its signed distance gradient direction. 
%We continue along this flow until the fine mesh is full inside the coarse mesh. 
%In contrast to normal flows, this flow guides the fine mesh toward the medial axis
% of the coarse mesh.

\noindent \textbf{Re-inflation:} Next we reverse the flow,
marching the fine mesh back along its path, but now we resolve collisions with
the coarse mesh \emph{\`{a} la} physically based simulation. There are many
feasible embeddings for the coarse mesh so we regularize, treating the problem
as a constrained optimization:
\begin{align}
\min_{\mathbf{C}(t)}  &\quad E(\mathbf{C}(t)),\\
\text{subject to:} &\quad \text{$\mathbf{C}(t)$ does not intersect itself or $\mathbf{F}(t)$}.
\end{align}

In physics parlance, we find a static solution for each reverse time step as
$\mathbf{F}(t)$ moves like an infinite mass obstacle toward its original
position and pushes the deformable $\mathbf{C}(t)$ outward. We leverage state-of-the-art
physically-based simulation contact mechanics methods to satisfy these
constraints. 
Some choices for $E$ are total volume, surface and volumetric deformations.

\section{Results and current work}

\begin{figure}[t]
  \includegraphics[width=\linewidth]{figs/swat-cage}
  \caption{Given the a mesh and an initially overlapping coarse mesh (left) we
  flow it until it is completely inside the coarse mesh. We then re-inflate the
  fine mesh pushing the coarse mesh away to generate an enclosing cage. This
  cage can be used for deformation.}
  \label{fig:swat}
\end{figure}

\begin{figure}[t]
  \includegraphics[width=\linewidth]{figs/octopus-poisson}
  \caption{A single multiresolution v-cycle takes 1.4 secs on this 7M-vertex
  volumetric Poisson equation. With 14 more iterations (21 secs) the residual
  error matches a direct solver's (11 mins, back substitution only).}
  \label{fig:octopus}
\end{figure}

In Figure~\ref{fig:minizoo} we show some nested cages produced by our method
and in Figure~\ref{fig:swat} we show a single cage result. Our method took some
minutes to generate these results. The input \emph{S.W.A.T. man} mesh has a lot
of artefacts such as self-intersecting pairs and non-manifold edges and our
flow is robust to them. In this case we have obtained a symmetric enclosing
cage by minimizing a symmetry energy $E$ over the coarse mesh.

Our cages find immediate application to solve volumetric PDEs using finite
elements (Figure~\ref{fig:octopus}). Nestedness makes linear interpolation a
good prolongation operator for the v-cycles, and performing multigrid with our
meshes compares favourably over direct solvers in terms of speed and memory.

%\section{Ongoing work}

We are currently investigating strategies to regularize the flow in
(\ref{eq:energy_gradient}), which may fail to flow inside when fine and initial
coarse meshes have very different medial axes or when the coarse mesh has thin
features. We are also searching for properties of the initial decimations that
provide our method guarantees to work. 
%We also look forward to improving upon our method by considering optimizing
%all layers simultaneously, instead of pairwise.

%Use of Bibtex is not necessary, but strongly recommended.
%Please make sure that references are displayed in a uniform fashion
\bibliographystyle{abbrv}
\bibliography{references}
 
\end{document}


